<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
    <title>Pathfinding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#78dcca",
              secondary: "#126764",
              code: "#dbdbdb",
              "code-important": "#78dcc0",
            },
          },
        },
      };
    </script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.10.5/dist/cdn.min.js"
    ></script>
    <script src="../src/pathfinding-fx.js"></script>
  </head>
  <body class="overflow-x-hidden bg-gray-50">
    <div class="bg-gray-100 text-gray-700 min-h-screen">
      <div class="container mx-auto">
        <div class="p-8 text-center">
          <h1 class="text-primary text-4xl">pathfinding-fx.js</h1>
          <p>
            A visualization library experiment for interactive website effects
            based on pathfinding algorithms
          </p>
        </div>
      </div>

      <div class="container mx-auto my-2 flex flex-col gap-4">
        <div class="flex flex-col lg:flex-row gap-4">
          <div
            id="demo-examples"
            style="max-width: 500px"
            class="flex-none w-full mx-auto"
          ></div>
          <div class="flex-grow flex flex-col gap-4">
            <div
              class="flex flex-none flex-wrap justify-center lg:justify-start gap-2 items-center text-sm"
            >
              <a
                onclick="loadExamplePathfinding()"
                data-demo="ExamplePathfinding"
                class="text-white bg-primary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Pathfinding
              </a>
              <a
                onclick="loadExampleDataFlow()"
                data-demo="ExampleDataFlow"
                class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Data Flow
              </a>
              <a
                onclick="loadExampleMazeRunners()"
                data-demo="ExampleMazeRunners"
                class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Maze Runners
              </a>
              <a
                onclick="loadExampleFlooding()"
                data-demo="ExampleFlooding"
                class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Flooding
              </a>
              <a
                onclick="loadExampleMountainClimber()"
                data-demo="ExampleMountainClimber"
                class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Mountain Climber
              </a>
              <a
                onclick="loadExampleLightSource()"
                data-demo="ExampleLightSource"
                class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap"
              >
                Lightbulb
              </a>
              <!--<a onclick="clearDemo()">Clear</a>-->
            </div>
            <div
              class="flex-1 flex flex-col gap-2 justify-between py-12 px-4 lg:px-0"
            >
              <div class="flex flex-col gap-4">
                <h2 id="example-title" class="text-3xl font-serif"></h2>
                <p
                  id="example-description"
                  class="text-lg font-sans max-w-[500px] inline-block text-justify"
                ></p>
              </div>
              <div>
                <p id="example-instructions" class="text-md font-mono"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex flex-col gap-0 divide-y-2">
      <!-- PFX :: initialization() -->
      <div
        class="grid grid-cols-1 lg:grid-cols-3 lg:divide-x-2 gap-4 p-4 container mx-auto py-8"
        x-data="initialization()"
      >
        <div class="w-[300px] justify-center flex flex-col gap-4">
          <h1 class="text-xl font-serif">PFX :: Initialization</h1>
          <p class="text-justify">
            Initialize PathfindingFX by instantiating a new PathfindingFX Object
            and pass in the element where the canvas should be drawn into.
          </p>
          <p class="text-justify">
            As a second parameter pass in your settings, the most basic one is
            passing a map settings with a two-dimensional array giving
            information about what is a wall and what not.
          </p>
        </div>
        <div class="flex items-center justify-center">
          <div>
            <div id="initialization" style="max-width: 225px"></div>
            <script>
              const initialization = () => ({
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                run() {
                  const PFX = new PathfindingFX(
                    document.getElementById("initialization"),
                    { map: this.map }
                  );

                  //PFX.drawMap();
                  PFX.onUpdateMap = (map) => {
                    this.map = map;
                  };
                },
                init() {
                  this.run();
                },
              });
            </script>
          </div>
        </div>
        <div class="text-center lg:text-left lg:pl-4">
          <a
            onclick="this.nextElementSibling.classList.toggle('hidden')"
            data-demo="ExampleDataFlow"
            class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap lg:hidden"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 inline"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5"
              />
            </svg>
            Toggle Code
          </a>

          <div class="hidden lg:block text-left">
            <pre>
              <code class="text-xs">
const PFX = new PathfindingFX(
  document.getElementById("pfx-initialization"),
  { 
    map:
      [
        <span x-html='"["+map.join("],\n        [")+"]"'></span>
      ], 
  }
);
              </code>
            </pre>
          </div>
        </div>
      </div>

      <!-- PFX :: addNode() -->
      <div
        class="grid grid-cols-1 lg:grid-cols-3 lg:divide-x-2 gap-4 p-4 container mx-auto py-8"
        x-data="addNode()"
      >
        <div class="w-[300px] justify-center flex flex-col gap-4">
          <h1 class="text-xl font-serif">PFX :: Adding nodes</h1>
          <p class="text-justify">
            Adds nodes to the canvas. The addNode method accepts an object of
            settings. The most important one is the <i>"pos"</i> property which
            includes a x and y position based on the current map (starting from
            zero in the top left corner)
          </p>
          <p class="text-justify">
            There are more settings, for example the style property defining the
            shape and color of the node.
          </p>
        </div>
        <div class="flex items-center justify-center">
          <div>
            <div id="addNode" style="max-width: 225px"></div>
            <script>
              const addNode = () => ({
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                nodeA: { pos: { x: 2, y: 2 }, style: { color: "#2a9d8f" } },
                nodeB: {
                  pos: { x: 6, y: 3 },
                  style: { color: "#e76f51", shape: "circle" },
                },
                run() {
                  this.nodeA.onPosChange = (node, pos) => {
                    this.nodeA.pos.x = node.pos.x;
                    this.nodeA.pos.y = node.pos.y;
                  };
                  this.nodeB.onPosChange = (node, pos) => {
                    this.nodeB.pos.x = node.pos.x;
                    this.nodeB.pos.y = node.pos.y;
                  };

                  const PFX = new PathfindingFX(
                    document.getElementById("addNode"),
                    { map: this.map }
                  )
                    .drawMap()
                    .addNode(this.nodeA)
                    .addNode(this.nodeB)
                    .render();
                },
                init() {
                  this.run();
                },
              });
            </script>
          </div>
        </div>

        <div class="text-center lg:text-left lg:pl-4">
          <a
            onclick="this.nextElementSibling.classList.toggle('hidden')"
            data-demo="ExampleDataFlow"
            class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap lg:hidden"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 inline"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5"
              />
            </svg>
            Toggle Code
          </a>

          <div class="hidden lg:block text-left">
            <pre>
          <code class="text-xs">

const PFX = new PathfindingFX([...]);

const nodeA = <span x-html="JSON.stringify(nodeA, null, 4)"></span>;
const nodeB = <span x-html="JSON.stringify(nodeB, null, 4)"></span>;

PFX.addNode(nodeA);
PFX.addNode(nodeB);

        </code>
      </pre>
          </div>
        </div>
      </div>

      <!-- PFX :: findPath() -->
      <div
        class="grid grid-cols-1 lg:grid-cols-3 lg:divide-x-2 gap-4 p-4 container mx-auto py-8"
        x-data="findPath()"
      >
        <div class="w-[300px] justify-center flex flex-col gap-4">
          <h1 class="text-xl font-serif">PFX :: Finding the path</h1>
          <p class="text-justify">
            Every added node can have its path calculated by giving it a <i>"to"</i>
            property containing the <i>"pos"</i> to which x/y point the path should be
            found.
          </p>
          <p class="text-justify">
            Like a node itself, the <i>"to"</i> property can have more settings like,
            again, a style property
          </p>
          <div>
          <input type="checkbox" x-model="toStyle" /> <span class="font-mono text-xs">Toggle Style</span>
        </div>
        </div>
        <div class="flex items-center justify-center">
          <div>
            <div id="findPath" style="max-width: 225px"></div>
            <script>
              const findPath = () => ({
                pfx: null,
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                node: {
                  pos: { x: 2, y: 2 },
                  style: { color: "#457b9d" },
                  to: { pos: { x: 6, y: 3 } },
                },
                toStyle: false,
                run() {
                  this.node.to.onPosChange = (node, pos) => {
                    this.node.to.pos.x = node.pos.x;
                    this.node.to.pos.y = node.pos.y;
                  };

                  this.pfx = new PathfindingFX(
                    document.getElementById("findPath"),
                    { map: this.map }
                  )
                    .drawMap()
                    .addNode(this.node);
                },
                init() {
                  this.run();
                  this.$watch("toStyle", (value) => {
                    if (value) {
                      this.node.to.style = {
                        color: "#bb3e03",
                        shape: "circle",
                        size: { w: 0.5, h: 0.5 },
                      };
                      this.pfx.nodesList[0].to.style = this.node.to.style;
                    } else {
                      delete this.node.to.style;
                      this.pfx.nodesList[0].to.style = this.node.to.style;
                    }
                    this.pfx.render();
                    /*this.pfx.reset();
                    console.log(this.map);
                    this.run();*/
                  });
                },
              });
            </script>
          </div>
        </div>

        <div class="text-center lg:text-left lg:pl-4">
          <a
            onclick="this.nextElementSibling.classList.toggle('hidden')"
            data-demo="ExampleDataFlow"
            class="text-white bg-secondary px-3 py-2 rounded-lg cursor-pointer whitespace-nowrap lg:hidden"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-5 h-5 inline"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5"
              />
            </svg>
            Toggle Code
          </a>

          <div class="hidden lg:block text-left">
            <pre>
          <code class="text-xs">

const PFX = new PathfindingFX([...]);

const node = {[...],
  to: <span x-html="JSON.stringify(node.to, null, 4)"></span>
};

PFX.addNode(node);

        </code>
      </pre>
          </div>
        </div>
      </div>

      <!-- PFX :: drawFlood() -->
      <div
        class="grid grid-cols-1 lg:grid-cols-3 lg:divide-x-2 gap-4 p-4 container mx-auto py-8"
        x-data="flood()"
      >
        <div class="w-[300px] justify-center flex flex-col gap-4">
          <h1 class="text-xl font-serif">PFX :: positions()</h1>
          <p class="text-justify">
            Initialize PathfindingFX by instantiating a new PathfindingFX Object
            and pass in the element where the canvas should be drawn into.
          </p>
          <p class="text-justify">
            As a second parameter pass in your settings, the most basic one is
            passing a map settings with a two-dimensional array giving
            information about what is a wall and what not.
          </p>
        </div>
        <div class="flex items-center justify-center">
          <div>
            <div id="flood" style="max-width: 225px"></div>
            <script>
              const flood = () => ({
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                step: null,
                sliderValueMax: null,
                greedy: true,
                run() {
                  if (document.querySelector("#flood > canvas"))
                    document.querySelector("#flood > canvas").remove();

                  const PFX = new PathfindingFX(
                    document.getElementById("flood"),
                    { map: this.map }
                  );

                  PFX.drawMap();

                  const node = { pos: { x: 2, y: 3 } };

                  PFX.addNode(node);
                  const aP = PFX.positions(node.pos);
                  this.sliderValueMax = Math.ceil(
                    Math.max(...aP.map((n) => n.g))
                  );

                  if (this.step === null)
                    this.step = Math.round(this.sliderValueMax / 2);

                  PFX.positions(node.pos)
                    .filter((n) => n.g <= this.step)
                    .map((n) => {
                      PFX.addNode({ ...n, ...{ style: { color: "red" } } });
                    });

                  /*const flood = PFX.findFlood(fromNode.pos, toNode.pos, {
                  greedy: this.greedy,
                }); */
                },
                init() {
                  this.run();
                  this.$watch("step", (value) => this.run());
                  this.$watch("greedy", (value) => this.run());
                },
              });
            </script>
          </div>
        </div>
        <div class="lg:pl-4">
          <pre>
            <code>
              
          </code>
        </pre>

          <input
            id="default-range"
            type="range"
            x-model="step"
            min="0"
            :max="sliderValueMax"
            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"
          />
        </div>
      </div>

      <!-- PFX :: Weighted Map -->
      <div
        class="grid grid-cols-1 lg:grid-cols-3 lg:divide-x-2 gap-4 p-4 container mx-auto py-8"
        x-data="weighted()"
      >
        <div class="w-[300px] justify-center flex flex-col gap-4">
          <h1 class="text-xl font-serif">PFX :: map weights</h1>
          <p class="text-justify">
            Initialize PathfindingFX by instantiating a new PathfindingFX Object
            and pass in the element where the canvas should be drawn into.
          </p>
          <p class="text-justify">
            As a second parameter pass in your settings, the most basic one is
            passing a map settings with a two-dimensional array giving
            information about what is a wall and what not.
          </p>
        </div>
        <div class="flex items-center justify-center">
          <div>
            <div id="weighted" style="max-width: 225px"></div>
            <script>
              const weighted = () => ({
                PFXObj: null,
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 1, 2, 3, 4, 0],
                  [0, 1, 1, 1, 2, 3, 3, 3, 0],
                  [0, 1, 1, 1, 2, 3, 3, 2, 0],
                  [0, 1, 1, 3, 4, 2, 2, 1, 0],
                  [0, 1, 2, 3, 4, 2, 1, 1, 0],
                  [0, 1, 2, 2, 3, 2, 1, 1, 0],
                  [0, 1, 1, 1, 2, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                fromNode: { pos: { x: 2, y: 2 }, style: { color: "purple" } },
                toNode: { pos: { x: 6, y: 5 } },
                run() {
                  const PFX = new PathfindingFX(
                    document.getElementById("weighted"),
                    { map: this.map }
                  );

                  // PFX.drawMap();
                  PFX.addNode({ ...this.fromNode, ...{ to: this.toNode } });
                  PFX.render();
                },
                init() {
                  this.run();
                },
              });
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-5 bg-secondary">
      <div class="container mx-auto p-8 text-white">
        Made with
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6 inline motion-safe:animate-bounce"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"
          />
        </svg>
        by
        <a href="https://marcoplain.com" target="_blank" class="text-primary">
          Marco Plain
        </a>
        <p class="text-sm text-gray-300">
          Designed with
          <a
            href="https://tailwindcss.com/"
            target="_blank"
            class="text-primary"
            >TailwindCSS</a
          >
          <br />
          Interactions realized by
          <a href="https://alpinejs.dev/" target="_blank" class="text-primary"
            >Alpine</a
          >
        </p>
      </div>
    </div>

    <script src="./script.js"></script>
  </body>
</html>
