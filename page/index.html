<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pathfinding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#78dcca",
              secondary: "#126764",
              code: "#dbdbdb",
              "code-important": "#78dcc0",
            },
          },
        },
      };
    </script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.10.5/dist/cdn.min.js"
    ></script>
    <script src="../src/pathfinding-fx.js"></script>
  </head>
  <body class="bg-gray-100 text-gray-700 overflow-x-hidden">
    <div class="container mx-auto">
      <div class="p-8 text-center">
        <h1 class="text-primary text-4xl">pathfinding-fx.js</h1>
        <p>
          A visualization library for stunning website effects based on
          pathfinding algorithms
        </p>
      </div>
    </div>

    <div class="container mx-auto my-2">
      <a onclick="loadPathfinding()">Example 1</a>
      <a onclick="loadExampleDataFlow()">Data Flow</a>
      <a onclick="loadExampleMazeRunners()">Maze Runners</a>
      <a onclick="loadExampleFlooding()">Flooding</a>
      <a onclick="clearDemo()">Clear</a>

      <div
        id="demo-examples"
        style="height: 500px; width: 500px"
        class="mx-auto border border-[#dbdbdb] border-4 bg-[#f8f8f8] rounded box-content"
      ></div>
    </div>

    <!-- autoload-usage -->
    <!--<div class="bg-gray-500 my-8 flex gap-4 p-8">
        <div>
          <div class="bg-blue-200 mb-2">
            <canvas
              width="200"
              height="200"
              data-pathfinding="[
                [0,0,0,0,0,0,0,0,0],
                [0,1,1,1,1,1,1,1,0],
                [0,1,1,1,1,1,1,1,0],
                [0,1,1,1,0,1,1,1,0],
                [0,1,1,1,0,1,1,1,0],
                [0,1,1,1,0,1,1,1,0],
                [0,1,1,1,1,1,1,1,0],
                [0,1,1,1,1,1,1,1,0],
                [0,0,0,0,0,0,0,0,0]
            ]"
              data-from='{"x":"2", "y":"4"}'
              data-to='{"x":"6", "y":"4"}'
            ></canvas>
          </div>
          <button
            class="bg-primary text-black rounded p-1.5"
            onclick='PathfindingFX.init(document.querySelectorAll("[data-pathfinding]"))'
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"
              />
            </svg>
          </button>
        </div>
        <div>
          <h1 class="text-xl text-primary uppercase">Autoloading</h1>
          <p>
            Use <code>data-pathfinding</code> for inline path drawing
            autoloading
          </p>
          <pre><code class="text-code">&lt;canvas style="width:225px; height:225px;" 
    <span class="text-code-important">data-pathfinding="[
        [0,0,0,0,0,0,0,0,0],
        [0,1,1,1,1,1,1,1,0],
        [0,1,1,1,1,1,1,1,0],
        [0,1,1,1,0,1,1,1,0],
        [0,1,1,1,0,1,1,1,0],
        [0,1,1,1,0,1,1,1,0],
        [0,1,1,1,1,1,1,1,0],
        [0,1,1,1,1,1,1,1,0],
        [0,0,0,0,0,0,0,0,0]
    ]"
    data-from='{"x":"2", "y":"4"}'
    data-to='{"x":"6", "y":"4"}'</span>
&gt;&lt;/canvas&gt;</code></pre>
        </div>
      </div>-->

    <!-- PFX :: drawMap() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="drawMap()">
      <div>
        <div class="bg-blue-200">
          <div id="drawMap" style="width: 225px; height: 225px"></div>
          <script>
            const drawMap = () => ({
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              run() {
                const PFX = new PathfindingFX(
                  document.getElementById("drawMap"),
                  { map: this.map }
                );

                PFX.drawMap();
                PFX.onUpdateMap = (map) => {
                  this.map = map;
                };
              },
              init() {
                this.run();
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">PFX :: drawMap()</h1>
        <pre>
            <code>
const PFX = new PathfindingFX(
    document.getElementById("drawMap"),
    { 
        map: [
          <span x-html='map.join("\n          ")'></span>
        ], 
    }
);

PFX.drawMap();

          </code>
        </pre>
      </div>
    </div>

    <!-- PFX :: addNode() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="addNode()">
      <div>
        <div class="bg-blue-200">
          <div id="addNode" style="width: 225px; height: 225px"></div>
          <script>
            const addNode = () => ({
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              nodeA: { pos: { x: 2, y: 2 }, style: { color: "#2a9d8f" } },
              nodeB: {
                pos: { x: 6, y: 3 },
                style: { color: "#e76f51" },
                to: { pos: { x: 6, y: 6 } },
              },
              run() {
                const PFX = new PathfindingFX(
                  document.getElementById("addNode"),
                  { map: this.map }
                )
                  .drawMap()
                  .addNode(this.nodeA)
                  .addNode(this.nodeB);
              },
              init() {
                this.run();
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">PFX :: addNode()</h1>
        <pre>
            <code>
const nodeA = <span x-html="JSON.stringify(nodeA)"></span>;
const nodeB = <span x-html="JSON.stringify(nodeB)"></span>;

PFX.addNode(nodeA);
PFX.addNode(nodeB);

          </code>
        </pre>
      </div>
    </div>

    <!-- PFX :: addPath() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="addPath()">
      <div>
        <div class="bg-blue-200">
          <div id="addPath" style="width: 225px; height: 225px"></div>
          <script>
            const addPath = () => ({
              PFXObj: null,
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              from: { pos: { x: 2, y: 2 } },
              to: { pos: { x: 6, y: 3 } },
              run() {
                const PFX = new PathfindingFX(
                  document.getElementById("addPath"),
                  { map: this.map }
                )
                  .drawMap()
                  .addPath({ from: this.from, to: this.to });

                //PFX.drawNodes(path);

                /*PFX.addNode(this.fromNode, {
                  color: "red",
                  onPosChange: (node, pos) => {
                    this.fromNode.pos.x = pos.pos.x;
                    this.fromNode.pos.y = pos.pos.y;
                  },
                });
                PFX.addNode(this.toNode, {
                  color: "green",
                  onPosChange: (node, pos) => {
                    this.toNode.pos = pos;
                  },
                });*/

                //PFX.render();
              },
              init() {
                this.run();
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">PFX :: addPath()</h1>

        <pre>
            <code>
const from = <span x-html="JSON.stringify(from)"></span>;
const to = <span x-html="JSON.stringify(to)"></span>;

PFX.addPath({from:from, to:to});

          </code>
        </pre>
      </div>
    </div>

    <!-- PFX :: drawNodes with max() -->
    <!-- <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="drawNodesWithSteps()">
        <div>
          <div class="bg-blue-200">
            <div id="drawNodesWithSteps" style="width:225px; height:225px;"></div>
            <script>
              const drawNodesWithSteps = () => ({
                PFXObj: null,
                map: [
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 0, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 1, 1, 1, 1, 1, 1, 1, 0],
                  [0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                fromNode: { x: 2, y: 3 },
                toNode: { x: 6, y: 3 },
                step: null,
                sliderValueMax: null,
                run() {
                  const PFX = new PathfindingFX(
                    document.getElementById("drawNodesWithSteps"),
                    { map: this.map }
                  );
                  this.PFXObj = PFX;

                  PFX.drawMap();

                  const path = PFX.addPath(this.fromNode, this.toNode);
                  this.sliderValueMax = path.length;
                  if (this.step === null) {
                    this.step = Math.round(this.sliderValueMax / 2);
                  }

                  PFX.drawNodes(path.filter((p) => p.g <= this.step));

                  PFX.addNode(this.fromNode, { color: "red" });
                  PFX.addNode(this.toNode, { color: "green" });

                  PFX.onNodesListUpdate = (nodesList) => {
                    nodesList.forEach((node) => {
                      if (node.config.color == "red") {
                        this.fromNode.pos.x = node.pos.x;
                        this.fromNode.pos.y = node.pos.y;
                      }
                      if (node.config.color == "green") {
                        this.toNode.pos.x = node.pos.x;
                        this.toNode.pos.y = node.pos.y;
                      }
                      const PFX = this.PFXObj;
                      PFX.clearAllPaths();

                      const path = PFX.addPath(this.fromNode, this.toNode);
                      this.sliderValueMax = path.length;
                      this.step = Math.round(this.sliderValueMax / 2);

                      PFX.drawNodes(path.filter((p) => p.g <= this.step));
                    });
                  };
                },
                init() {
                  this.run();
                  this.$watch("step", (value) => this.run());
                },
              });
            </script>
          </div>
        </div>
        <div>
          <h1 class="text-xl text-primary">PFX :: drawNodes with steps()</h1>
          <input
            id="default-range"
            type="range"
            x-model="step"
            min="0"
            :max="sliderValueMax"
            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"
          />
          <pre>
            <code>
const fromNode = { x: 2, y: 3 };
const toNode = { x: 6, y: 3 };

PFX.addStartNode(fromNode);
PFX.addEndNode(toNode);

const path = PFX.findPath(fromNode, toNode);

PFX.drawNodes(path);
          </code>
        </pre>
        </div>
      </div>-->

    <!-- PFX :: drawFlood() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="flood()">
      <div>
        <div class="bg-blue-200">
          <div id="flood" style="width: 225px; height: 225px"></div>
          <script>
            const flood = () => ({
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              step: null,
              sliderValueMax: null,
              greedy: true,
              run() {
                if (document.querySelector("#flood > canvas"))
                  document.querySelector("#flood > canvas").remove();

                const PFX = new PathfindingFX(
                  document.getElementById("flood"),
                  { map: this.map }
                );

                PFX.drawMap();

                const node = { pos: { x: 2, y: 3 } };

                PFX.addNode(node);
                const aP = PFX.getAccessiblePositions(node.pos);
                this.sliderValueMax = Math.ceil(
                  Math.max(...aP.map((n) => n.g))
                );

                if (this.step === null)
                  this.step = Math.round(this.sliderValueMax / 2);

                PFX.getAccessiblePositions(node.pos)
                  .filter((n) => n.g <= this.step)
                  .map((n) => {
                    PFX.addNode({ ...n, ...{ style: { color: 'red' } } });
                  });

                /*const flood = PFX.findFlood(fromNode.pos, toNode.pos, {
                  greedy: this.greedy,
                }); */
              },
              init() {
                this.run();
                this.$watch("step", (value) => this.run());
                this.$watch("greedy", (value) => this.run());
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">Flooding</h1>
        <input
          id="default-range"
          type="range"
          x-model="step"
          min="0"
          :max="sliderValueMax"
          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"
        />
        <input type="checkbox" x-model="greedy" />
        <pre>
            <code>
              
          </code>
        </pre>
      </div>
    </div>

    <!-- PFX :: sequence() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="sequence()">
      <div>
        <div class="bg-blue-200">
          <div id="sequence" style="width: 225px; height: 225px"></div>
          <script>
            const sequence = () => ({
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 0, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              step: null,
              sliderValueMax: null,
              greedy: true,
              run() {
                if (document.querySelector("#sequence > canvas"))
                  document.querySelector("#sequence > canvas").remove();

                const PFX = new PathfindingFX(
                  document.getElementById("sequence"),
                  { map: this.map }
                );

                PFX.drawMap();

                const node = { pos: { x: 2, y: 3 } };

                PFX.addNode(node);
                const aP = PFX.getAccessiblePositions(node.pos);
                this.sliderValueMax = aP.length;

                if (this.step === null)
                  this.step = Math.round(this.sliderValueMax / 2);

                PFX.getAccessiblePositions(node.pos)
                  .filter((n,k) => k < this.step)
                  .map((n) => {
                    PFX.addNode({ ...n, ...{ style: { color: 'red' } } });
                  });

                /*const flood = PFX.findFlood(fromNode.pos, toNode.pos, {
                  greedy: this.greedy,
                }); */
              },
              init() {
                this.run();
                this.$watch("step", (value) => this.run());
                this.$watch("greedy", (value) => this.run());
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">Sequencing</h1>
        <input
          id="default-range"
          type="range"
          x-model="step"
          min="0"
          :max="sliderValueMax"
          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"
        />
        <input type="checkbox" x-model="greedy" />
        <pre>
            <code>
              
          </code>
        </pre>
      </div>
    </div>

    <!-- PFX :: Walker() -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="walker()">
      <div>
        <div class="bg-blue-200">
          <div id="walker" style="width: 225px; height: 225px"></div>
          <script>
            const walker = () => ({
              PFXObj: null,
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 1, 1, 1, 1, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              fromNode: { pos: { x: 2, y: 2 } },
              toNode: { pos: { x: 6, y: 5 } },
              run() {
                const PFX = new PathfindingFX(
                  document.getElementById("walker"),
                  { map: this.map }
                );

                // PFX.drawMap();
                PFX.addNode({ ...this.fromNode, ...{ to: this.toNode } });
                PFX.render();
              },
              init() {
                this.run();
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">PFX :: Walker</h1>

        <pre>
            <code>
const fromNode = <span x-html="JSON.stringify(fromNode, ['x','y'])"></span>;
const toNode = <span x-html="JSON.stringify(toNode, ['x','y'])"></span>;

PFX.addStartNode(fromNode);
PFX.addEndNode(toNode);

const path = PFX.findPath(fromNode, toNode);

PFX.drawNodes(path);
          </code>
        </pre>
      </div>
    </div>


    <!-- PFX :: Weighted Map -->
    <div class="bg-gray-500 my-8 flex gap-4 p-8" x-data="weighted()">
      <div>
        <div class="bg-blue-200">
          <div id="weighted" style="width: 225px; height: 225px"></div>
          <script>
            const weighted = () => ({
              PFXObj: null,
              map: [
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 1, 1, 1, 1, 2, 3, 4, 0],
                [0, 1, 1, 1, 2, 3, 3, 3, 0],
                [0, 1, 1, 1, 2, 3, 3, 2, 0],
                [0, 1, 1, 3, 4, 2, 2, 1, 0],
                [0, 1, 2, 3, 4, 2, 1, 1, 0],
                [0, 1, 2, 2, 3, 2, 1, 1, 0],
                [0, 1, 1, 1, 2, 1, 1, 1, 0],
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
              ],
              fromNode: { pos: { x: 2, y: 2 }, style: {color:"purple"} },
              toNode: { pos: { x: 6, y: 5 } },
              run() {
                const PFX = new PathfindingFX(
                  document.getElementById("weighted"),
                  { map: this.map }
                );

                // PFX.drawMap();
                PFX.addNode({ ...this.fromNode, ...{ to: this.toNode } });
                PFX.render();
              },
              init() {
                this.run();
              },
            });
          </script>
        </div>
      </div>
      <div>
        <h1 class="text-xl text-primary">PFX :: Weighted Map</h1>

        <pre>
            <code>
const fromNode = <span x-html="JSON.stringify(fromNode, ['x','y'])"></span>;
const toNode = <span x-html="JSON.stringify(toNode, ['x','y'])"></span>;

PFX.addStartNode(fromNode);
PFX.addEndNode(toNode);

const path = PFX.findPath(fromNode, toNode);

PFX.drawNodes(path);
          </code>
        </pre>
      </div>
    </div>

    <div class="text-center mt-5 bg-secondary">
      <div class="container mx-auto p-8">
        Made with
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6 inline motion-safe:animate-bounce"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"
          />
        </svg>
        by
        <a href="https://marcoplain.com" target="_blank" class="text-primary">
          Marco Plain
        </a>
        <p class="text-sm text-gray-300">
          Designed with
          <a
            href="https://tailwindcss.com/"
            target="_blank"
            class="text-primary"
            >TailwindCSS</a
          >
          <br />
          Interactions realized by
          <a href="https://alpinejs.dev/" target="_blank" class="text-primary"
            >Alpine</a
          >
        </p>
      </div>
    </div>

    <script src="./script.js"></script>
  </body>
</html>
